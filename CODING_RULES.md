# DramaEngine コーディング規約

## 目的
実行速度、メモリ効率、安全性、メンテナンス性を同水準で保つ。

## 適用範囲
プロジェクトに含まれるすべてのプログラミング言語が対象。

## 自動整形
- **clang-format** 使用
- スタイル: **Allman**

---

## 命名規則

| 種別 | 規則 | 例 |
|------|------|-----|
| 型 (class/struct/enum) | PascalCase | `RenderEngine` |
| 関数 | snake_case | `get_device()` |
| 変数 | camelCase | `frameCount` |
| メンバ変数 | m_ + camelCase | `m_frameCount` |
| 定数 | k_ + camelCase | `k_maxBufferSize` |
| bool | 疑問形 | `isEnabled`, `hasData` |

### 備考
- 頭字語は最初のみ大文字（例: `Http`, `Xml`）

---

## ファイルとフォルダ

- ファイル名は**大文字始まり**（PascalCase）
- フォルダ構成:
  ```
  projects/
  ├── include/    # ヘッダファイル
  ├── source/     # ソースファイル
  └── shader/     # シェーダファイル
  ```

---

## ヘッダ規約

- `using namespace` **禁止**
- インクルードガードは `#pragma once` で統一
- インクルード順序:
  1. 自分のヘッダ
  2. 標準ライブラリ
  3. 外部ライブラリ
- 前方宣言を活用し、依存を最小化

---

## 型・所有権・エラー処理

### 所有権
- 基本は `std::unique_ptr`
- 共有が必要な場合のみ `std::shared_ptr`
- 生ポインタは**非所有**の意味でのみ使用（所有目的での使用禁止）

### エラー処理
- 例外は使用しない（戻り値でエラーを返す）
- エラーを握りつぶさない
- `assert` はハードウェア障害など**再処理不可能**な場面でのみ使用
- 処理は安全に実行できることを確認してから実行
- 安全でない場合は通知・ログを出力し、処理を取り消す

---

## コメント・ドキュメント

- コメントは **Why（なぜ）** を書く（Whatはコードで表現）
- 公開APIのみ **Doxygen形式** で記述
- 関数は **// 1)** や **// 2)** で処理の流れや内容を分かりやすいようにする
- 言語:
  - C++/その他: **日本語**
  - `.hlsli` (HLSL): **英語**

---

## 外部ライブラリ・ファイル

- 警告はすべて無効化
- 書き換え**禁止**
- 同ソリューション内でプロジェクトは分離
- ソースファイルのみの場合はそのまま使用

---

## 禁止事項

| 項目 | 理由 |
|------|------|
| ヘッダでのマクロ乱用 | 定数は `constexpr` を使用 |
| 暗黙的型変換 | 意図しない変換を防止 |
| `new`/`delete` の直書き | スマートポインタを使用 |
| グローバル可変変数 | 状態管理の複雑化を防止 |
